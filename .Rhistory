}
i=1
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
mae2[i] <- cor(fcast2[['mean']],xnext)^2
cor(fcast2[['mean']],xnext)^2
length(fcast2[['mean']])
length(xnext)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2<- matrix(NA,eff)
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
i=2
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
i=3
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
i=4
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:(k+i))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:(k+i))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:(k+i)]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:((n-k)+i)]
xnext <- a10[((n-k)+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
i=1
((n-k)+i)
((n-k)+i)
mae2<- matrix(NA,eff)
for(i in 1:(n-k)){
print(i)
xshort <-a10[1:((n-k)+i)]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
mae2<- matrix(NA,eff)
for(i in 1:eff){
print(i)
xshort <-a10[1:(eff+i)]
xnext <- a10[(eff+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
i=1
xshort <-a10[1:(eff+i)]
xnext <- a10[(eff+i):n]
length(xshort)
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-1)):n]
length(xshort)
length(xnext)
mae2<- matrix(NA,eff)
for(i in 1:eff){
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+(i-2)):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
i=3
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
length(xshort)
length(xnext)
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=eff)
fcast2
eff
fcast2 <- forecast(fit2, h=(n-(k+(i-1))))
fcast2
print(length(fcast2[['mean']]))
print(length(xnext))
mae2<- matrix(NA,eff)
for(i in 1:eff){
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,1),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=(n-(k+(i-1))))
print(length(fcast2[['mean']]))
print(length(xnext))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE",
ylim=c(0.65,1.05))
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
mae2
auto.arima(sub_study$organic)
plot(auto.arima(sub_study$organic))
tv_arima=auto.arima(sub_study$organic,xreg=xreg_matrix,max.p=10)
tv_arima_fcast=forecast(tv_arima,xreg=xreg_matrix)
plot(tv_arima_fcast)
a10=sub_study$organic
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k
mae2<- matrix(NA,eff)
for(i in 1:eff){
print(i)
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=(n-(k+(i-1))))
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
mae2
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=(n-(k+(i-1))))
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(1,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=(n-(k+(i-1))))
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=5
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
eff
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- cor(fcast2[['mean']],xnext)^2
}
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- cor(fcast2[['mean']],xnext[1:pred_hor])^2
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
i=1
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):n]
length*xshort
length(xshort)
length(xnext)
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+i+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
i=1
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+i+pred_hor)]
(k+(i-1))
(k+i)
(k+i+pred_hor)
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
abs(fcast2[['mean']]-xnext)
length(xnext)
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=6
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=7
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
a10=a10/max(a10)
pred_hor=7
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=8
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=9
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
# fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=1
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
# fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
a10=sub_study$organic
pred_hor=1
k <- 50 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
# fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
summary(a10)
pred_hor=1
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
# fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=1
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML")
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
View(sub_study)
a10=sub_study$organic
pred_hor=1
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=sub_study$tv.spend)
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=sub_study$tv.spend, h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=1
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
pred_hor=1
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
i=1
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend))
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
pred_hor
a10=sub_study$organic
pred_hor=5
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
a10=sub_study$organic.home
pred_hor=5
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
a10=sub_study$paid.brand.sessions
pred_hor=5
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(0,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(1,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
a10=sub_study$organic
pred_hor=5
k <- 60 # minimum data length for fitting a model
n <- length(a10)
eff=n-k-pred_hor
mae2<- matrix(NA,eff)
for(i in 1:eff){
xshort <-a10[1:(k+(i-1))]
xnext <- a10[(k+i):(k+(i-1)+pred_hor)]
fit2 <- Arima(xshort, order=c(1,1,0),include.drift=TRUE, lambda=0, method="ML",xreg=c(sub_study$tv.spend[1:(k+(i-1))]))
# fit2 <- auto.arima(xshort)
fcast2 <- forecast(fit2,xreg=c(sub_study$tv.spend[1:(k+(i-1))]), h=pred_hor)
mae2[i] <- abs(fcast2[['mean']]-xnext)
}
plot(1:eff, mae2, type="l", col=2, xlab="horizon", ylab="MAE" )
