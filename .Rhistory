geom_line(aes(x=date,y=direct.home),"green")+
geom_line(aes(x=date,y=paid.brand.sessions))
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+ geom_line(aes(x=date,y=paid.brand.sessions))
traffic_plot
sub_study=na.omit(tv_data %>%
select(date,tv.spend,organic,organic.home,direct.home,paid.brand.sessions) %>%
arrange(desc(date)))
sub_study$paid.brand.sessions=as.numeric(as.character(sub_study$paid.brand.sessions))
View(sub_study)
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))
traffic_plot
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
summary(sub_study)
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=tv.spend)) +
xlab("Date")
tv_spend_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=tv.spend)) +
ggtitle("TV Spending")+ xlab("Date")+ylab("Dollars")
tv_spend_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")
traffic_plot
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources")
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="red"))+
geom_line(aes(x=date,y=organic.home,color="blue"))+
geom_line(aes(x=date,y=direct.home,color="green"))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="red",fill=FALSE))+
geom_line(aes(x=date,y=organic.home,color="blue"))+
geom_line(aes(x=date,y=direct.home,color="green"))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic.home,color="blue",fill=FALSE))+
geom_line(aes(x=date,y=organic,color="red",fill=FALSE))+
geom_line(aes(x=date,y=direct.home,color="green",fill=FALSE))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
geom_line(aes(x=date,y=paid.brand.sessions,fill=FALSE))+
traffic_plot
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="red",fill=FALSE))+
geom_line(aes(x=date,y=organic.home,color="blue",fill=FALSE))+
geom_line(aes(x=date,y=direct.home,color="green",fill=FALSE))+
geom_line(aes(x=date,y=paid.brand.sessions,fill=FALSE))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="red"))+
geom_line(aes(x=date,y=organic.home,color="blue"))+
geom_line(aes(x=date,y=direct.home,color="green"))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+  guides(fill=FALSE)
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="red"))+
geom_line(aes(x=date,y=organic.home,color="blue"))+
geom_line(aes(x=date,y=direct.home,color="green"))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+  guides(fill=FALSE) +
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
traffic_plot
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
?scale_fill_manual
gplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic),color="red")+
geom_line(aes(x=date,y=organic.home),color="blue")+
geom_line(aes(x=date,y=direct.home),color="green")+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_continuous(name="Sources",labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic))+
geom_line(aes(x=date,y=organic.home))+
geom_line(aes(x=date,y=direct.home))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(name="Sources",
values=c("red","blue","green","black"),
labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic))+
geom_line(aes(x=date,y=organic.home))+
geom_line(aes(x=date,y=direct.home))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_line_manual(name="Sources",
values=c("red","blue","green","black"),
labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic))+
geom_line(aes(x=date,y=organic.home))+
geom_line(aes(x=date,y=direct.home))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_color_manual(name="Sources",
values=c("red","blue","green","black"),
labels=c("Organic","Organic Home","Direct Home","Paid Brand"))
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home))+
geom_line(aes(x=date,y=direct.home))+
geom_line(aes(x=date,y=paid.brand.sessions))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")
traffic_plot
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
tv_spend_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=tv.spend,color="TV Spending")) +
ggtitle("TV Spending")+ xlab("Date")+ylab("Dollars")
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
ggtitle("Traffic")+xlab("Date")+ylab("Visits")
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+guide_legend(title="Source")
?guide_legend
?theme
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(fill=guide_legend(title="Source"))
traffic_plot
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_discrete(name = "Source")
traffic_plot
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(name = "Source")
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual(legend_title,name = "Source")
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
scale_fill_manual("Source")
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guide_legend(title="Source")
ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(color=guide_legend(title="sale year"))
tv_spend_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=tv.spend,color="TV Spending")) +
ggtitle("TV Spending")+ xlab("Date")+ylab("Dollars") +
guides(color=guide_legend(title=NULL))
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(color=guide_legend(title="Source"))
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
tv_spend_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=tv.spend,color="TV Spending")) +
xlab("Date")+ylab("Dollars") +
guides(color=guide_legend(title=NULL))
traffic_plot=ggplot(sub_study) + theme_bw()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(color=guide_legend(title="Source"))
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
tv_spend_plot=ggplot(sub_study) + theme_minimal()+
geom_line(aes(x=date,y=tv.spend,color="TV Spending")) +
xlab("Date")+ylab("Dollars") +
guides(color=guide_legend(title=NULL))
traffic_plot=ggplot(sub_study) + theme_minimal()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(color=guide_legend(title="Source"))
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
cor(sub_study)
sapply(sub_study,is.numeric)
cor(sub_study[,sapply(sub_study,is.numeric)])
M=cor(sub_study[,sapply(sub_study,is.numeric)])
corrplot(M, method = "circle")
library(corrplot)
install.packages("corrplot")
library(corrplot)
corrplot(M, method = "circle")
?corrplot
cor(sub_study[,sapply(sub_study,is.numeric)])
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
summary(sub_study)
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
?ccf
acf(sub_study$sub_study)
acf(sub_study$organic)
library(DBI)
library(RMySQL)
library(dbConnect)
con<-dbConnect(MySQL(),
user="attrread",
password="diamonds",
host="attribution.cxg3u5tpgfux.us-east-1.rds.amazonaws.com",
port=3306,
dbname="log_analysis"
)
library(xlsx)
library(lubridate)
library(ggplot2)
library(gridExtra)
library(corrplot)
tv_data=tbl_df(read.xlsx("tvanalysis.xlsx",2))
library(dplyr)
tv_data=tbl_df(read.xlsx("tvanalysis.xlsx",2))
tv_data$date=as.Date(as.character(tv_data$date),"%m/%d/%Y")+years(2000)
which(is.na(tv_data$date))
sub_study=na.omit(tv_data %>%
select(date,tv.spend,organic,organic.home,direct.home,paid.brand.sessions) %>%
arrange(desc(date)))
sub_study$paid.brand.sessions=as.numeric(as.character(sub_study$paid.brand.sessions))
tv_spend_plot=ggplot(sub_study) + theme_minimal()+
geom_line(aes(x=date,y=tv.spend,color="TV Spending")) +
xlab("Date")+ylab("Dollars") +
guides(color=guide_legend(title=NULL))
traffic_plot=ggplot(sub_study) + theme_minimal()+
geom_line(aes(x=date,y=organic,color="Organic"))+
geom_line(aes(x=date,y=organic.home,color="Organic Home"))+
geom_line(aes(x=date,y=direct.home,color="Direct Home"))+
geom_line(aes(x=date,y=paid.brand.sessions,color="Paid Brand"))+
ggtitle("Traffic")+xlab("Date")+ylab("Visits")+
guides(color=guide_legend(title="Source"))
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
acf(sub_study$organic)
pacf(sub_study$organic)
t=acf(sub_study$organic)
str(t)
acf(sub_study$organic.home)
acf(sub_study$direct.home)
acf(sub_study$paid.brand.sessions)
acf(sub_study$organic)
pacf(sub_study$organic)
acf(sub_study$organic.home)
pacf(sub_study$organic.home)
acf(sub_study$direct.home)
pacf(sub_study$direct.home)
acf(sub_study$paid.brand.sessions)
pacf(sub_study$paid.brand.sessions)
lm_fit_organic=lm(organic,datedata=sub_study)
lm_fit_organic=lm(organic~date,data=sub_study)
lm_fit_organic
acf(sub_study$organic)
pacf(sub_study$organic)
acf(lm_fit_organic$residuals)
pacf(lm_fit_organic$residuals)
pacf(sub_study$organic)
acf(sub_study$organic)
acf(lm_fit_organic$residuals)
acf(sub_study$organic)
acf(lm_fit_organic$residuals)
pacf(sub_study$organic)
pacf(lm_fit_organic$residuals)
acf(sub_study$organic)
acf(lm_fit_organic$residuals)
pacf(sub_study$organic)
pacf(lm_fit_organic$residuals)
acf(diff(sub_study$organic))
pacf(diff(sub_study$organic))
acf(sub_study$organic)
acf(lm_fit_organic$residuals)
acf(diff(sub_study$organic))
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
ccf(sub_study$tv.spend)
ccf(sub_study$tv.spend,sub_study$organic)
pccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic.home)
ccf(sub_study$tv.spend,sub_study$direct.home)
ccf(sub_study$tv.spend,sub_study$paid.brand.sessions)
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic.home)
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic.home)
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic.home)
ccf(sub_study$tv.spend,sub_study$direct.home)
ccf(sub_study$tv.spend,sub_study$paid.brand.sessions)
lm_fit_organic=lm(organic~date,data=sub_study)
acf(sub_study$organic)
acf(lm_fit_organic$residuals)
acf(diff(sub_study$organic))
grid.arrange(traffic_plot, tv_spend_plot, ncol = 1)
cor(sub_study[,sapply(sub_study,is.numeric)])[1,]
ccf(sub_study$tv.spend,sub_study$organic)
ccf(sub_study$tv.spend,sub_study$organic.home)
?ccf
o<-ccf(sub_study$tv.spend,sub_study$organic,plot=FALSE)
str(o)
o$acf
ccf(sub_study$tv.spend,sub_study$organic)
o$type
o$n.used
o$lag
o<-ccf(sub_study$tv.spend,sub_study$organic,plot=FALSE)
oh<-ccf(sub_study$tv.spend,sub_study$organic.home,plot=FALSE)
dh<-ccf(sub_study$tv.spend,sub_study$direct.home,plot=FALSE)
pbs<-ccf(sub_study$tv.spend,sub_study$paid.brand.sessions,plot=FALSE)
vars<-c("organic","organic.home","direct.home","paid.brand.sessions")
vars
library(tidyr)
tv_data=tbl_df(read.xlsx("tvanalysis.xlsx",2))
tv_data$date=as.Date(as.character(tv_data$date),"%m/%d/%Y")+years(2000)
sub_study=na.omit(tv_data %>%
select(date,tv.spend,organic,organic.home,direct.home,paid.brand.sessions) %>%
arrange(desc(date)))
sub_study$paid.brand.sessions=as.numeric(as.character(sub_study$paid.brand.sessions))
View(sub_study)
for (var in vars) {
print(var)
}
ccf.df=data.frame(Correlation=NULL,Lag=NULL,Source=NULL)
for (var in vars) {
summary(sub_study %>% select(var))
}
for (var in vars) {
names(sub_study) == var
}
for (var in vars) {
which(names(sub_study) == var)
}
var=vars[1]
var
which(names(sub_study) == var)
str(o)
ccf.df=data.frame(Correlation=NULL,Lag=NULL,Source=NULL)
for (var in vars) {
ind=which(names(sub_study) == var)
ccf_temp<-ccf(sub_study$tv.spend,sub_study[,ind],plot=FALSE)
ccf.df$Correlation=rbind(ccf.df$Correlation,ccf_temp$acf)
ccf.df$Lag=rbind(ccf.df$Lag,ccf_temp$lag)
ccf.df$Source=rbind(ccf.df$Source,rep(var,length(ccf_temp$lag)))
}
vars<-c("organic","organic.home","direct.home","paid.brand.sessions")
ccf.df=data.frame(Correlation=NULL,Lag=NULL,Source=NULL)
var
ind=which(names(sub_study) == var)
ind
ccf_temp<-ccf(sub_study$tv.spend,sub_study[,ind],plot=FALSE)
ccf.df$Correlation=rbind(ccf.df$Correlation,ccf_temp$acf)
ccf.df$Correlation=append(ccf.df$Correlation,ccf_temp$acf)
?append
append(ccf.df$Correlation,ccf_temp$acf)
append(ccf.df$Lag,ccf_temp$lag)
ccf.df
ccf.df$Correlation=rbind(ccf.df$Correlation,ccf_temp$acf)
ccf_temp$acf
ccf.df$Correlation
rbind(ccf.df$Correlation,ccf_temp$acf)
ccf.df$Correlation=rbind(ccf.df$Correlation,ccf_temp$acf)
class(ccf_temp$acf)
ccf.df$Correlation=rbind(ccf.df$Correlation,as.vector(ccf_temp$acf))
rbind(ccf.df$Correlation,as.vector(ccf_temp$acf))
ccf_temp$acf
plot(ccf_temp$acf)
ccf_temp_df=data.frame(Correlation=ccf_temp$acf,Lag=ccf_temp$lag,Source=rep(var,length(ccf_temp$lag)))
ccf_temp_df
ccf.df<-rbind(ccf.df,ccf_temp_df)
ccf.df
vars<-c("organic","organic.home","direct.home","paid.brand.sessions")
ccf.df=data.frame(Correlation=NULL,Lag=NULL,Source=NULL)
for (var in vars) {
ind=which(names(sub_study) == var)
ccf_temp<-ccf(sub_study$tv.spend,sub_study[,ind],plot=FALSE)
ccf_temp_df=data.frame(Correlation=ccf_temp$acf,Lag=ccf_temp$lag,Source=rep(var,length(ccf_temp$lag)))
ccf.df<-rbind(ccf.df,ccf_temp_df)
}
ccf.df
ggplot(ccf.df,aes(x=Lag,y=Correlation))+
geom_point()+facet_grid(.~Source)
ggplot(ccf.df,aes(x=Lag,y=Correlation))+
geom_point()+facet_grid(Source~.)
ggplot(ccf.df,aes(x=Lag,y=Correlation))+ theme_minimal()+
geom_point()+facet_grid(Source~.)
ggplot(ccf.df,aes(x=Lag,y=Correlation))+ theme_bw()+
geom_point()+facet_grid(Source~.)
library(plotly)
Sys.setenv("plotly_username"="JeffreyUslan")
Sys.setenv("plotly_api_key"="4txr51h2pd")
library(plotly)
CC_plot<-ggplot(ccf.df,aes(x=Lag,y=Correlation))+ theme_bw()+
geom_point()+facet_grid(Source~.)
CCF_plot<-ggplot(ccf.df,aes(x=Lag,y=Correlation))+ theme_bw()+
geom_point()+facet_grid(Source~.)
ggploty(CCF_plot)
library(plotly)
ggploty(CCF_plot)
?ggplotly
devtools::install_github("ropensci/plotly")
Sys.setenv("plotly_username"="JeffreyUslan")
Sys.setenv("plotly_api_key"="4txr51h2pd")
library(plotly)
